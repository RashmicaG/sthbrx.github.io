<!DOCTYPE html>
<html lang="en">
<head>
          <title>Store Half Byte-Reverse Indexed</title>
        <meta charset="utf-8" />
        <link href="https://sthbrx.github.io/atom.xml" type="application/atom+xml" rel="alternate" title="Store Half Byte-Reverse Indexed Full Atom Feed" />
        <link href="https://sthbrx.github.io/rss.xml" type="application/rss+xml" rel="alternate" title="Store Half Byte-Reverse Indexed RSS Feed" />


    <meta name="tags" content="petitboot" />
    <meta name="tags" content="goodposts" />
    <meta name="tags" content="autoboot" />
    <meta name="tags" content="realcontent" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://sthbrx.github.io/">Store Half Byte-Reverse Indexed <strong>A Power Technical Blog</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://sthbrx.github.io/blog/2015/06/02/autoboot/" rel="bookmark"
         title="Permalink to Petitboot Autoboot Changes">Petitboot Autoboot Changes</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2015-06-02T08:11:00+10:00">
      Tue 02 June 2015
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://sthbrx.github.io/author/samuel-mendoza-jonas.html">Samuel Mendoza-Jonas</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>The way autoboot behaves in Petitboot has undergone some significant changes recently, so in order to ward off any angry emails lets take a quick tour of how the new system works.</p>
<h2>Old &amp; Busted</h2>
<p>For some context, here is the old (or current depending on what you're running) section of the configuration screen.</p>
<p><img alt="Old Autoboot" src="/images/sammj/oldstyle.jpg"></p>
<p>This gives you three main options: don't autoboot, autoboot from anything, or autoboot only from a specific device. For the majority of installations this is fine, such as when you have only one default option, or know exactly which device you'll be booting from.</p>
<p>A side note about default options: it is important to note that not all boot options are valid <em>autoboot</em> options. A boot option is only considered for auto-booting if it is marked default, eg. 'set default' in GRUB and 'default' in PXE options.</p>
<h2>New Hotness</h2>
<p>Below is the new autoboot configuration.</p>
<p><img alt="New Autoboot" src="/images/sammj/newstyle.jpg"></p>
<p>The new design allows you to specify an ordered list of autoboot options.
The last two of the three buttons are self explanatory - clear the list and autoboot any device, or clear the list completely (no autoboot).</p>
<p>Selecting the first button, 'Add Device' brings up the following screen:</p>
<p><img alt="Device Selection" src="/images/sammj/devices.jpg"></p>
<p>From here you can select any device or <em>class</em> of device to add to the boot order. Once added to the boot order, the order of boot options can be changed with the left and right arrow keys, and removed from the list with the minus key ('-').</p>
<p>This allows you to create additional autoboot configurations such as "Try to boot from sda2, otherwise boot from the network", or "Give priority to PXE options from eth0, otherwise try any other netboot option".
You can retain the original behaviour by only putting one option into the list (either 'Any Device' or a specific device).</p>
<p>Presently you can add any option into the list and order them how you like - which means you can do silly things like this:</p>
<p><img alt="If you send me a bug report with this in it I may laugh at you" src="/images/sammj/redundant.jpg"></p>
<h2>IPMI</h2>
<p>Slightly prior to the boot order changes Petitboot also received an update to its IPMI handling. IPMI 'bootdev' commands allow you to override the current autoboot configuration remotely, either by specifying a device type to boot (eg. PXE), or by forcing Petitboot to boot into the 'setup' or 'safe' modes. IPMI overrides are either persistent or non-persistent. A non-persistent override will disappear after a successful boot - that is, a successful boot of a boot option, not booting to Petitboot itself - whereas a persistent override will, well, persist!</p>
<p>If there is an IPMI override currently active, it will appear in the configuration screen with an option to manually clear it:</p>
<p><img alt="IPMI Overrides" src="/images/sammj/ipmi.jpg"></p>
<hr>
<p>That sums up the recent changes to autoboot; a bit more flexibility in assigning priority, and options for more detailed autoboot order if you need it. New versions of Petitboot are backwards compatible and will recognise older saved settings, so updating your firmware won't cause your machines to start booting things at random.</p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>